<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#3d256d">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#3d256d">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/favicon.ico">
    
      
        <link rel="amphtml" href="https://www.kyleniewiada.org/amp/blog/2016/03/word-auto-journal-macro-for-lazy/" data-proofer-ignore>
      
    

    <!-- Messy way to capture custom page title to replace SEO Tags -->
    
    
    <title>Microsoft Word Auto-Journal Macro for the Lazy</title>
    <meta property="og:title" content="Microsoft Word Auto-Journal Macro for the Lazy" />

    <!-- Come and get me RSS readers -->
    <link type="application/atom+xml" rel="alternate" href="https://www.kyleniewiada.org/feed.xml" title="Kyle Niewiada&apos;s Website" />

    <!-- Critical Stylesheet -->
    <style type="text/css">
      
      @font-face{font-family:"Open Sans";font-display:swap;font-style:normal;font-weight:300;src:local("Open Sans Light"),local("OpenSans-Light"),url("/assets/fonts/open-sans-v17-latin-300.woff2") format("woff2"),url("/assets/fonts/open-sans-v17-latin-300.woff") format("woff")}@font-face{font-family:"Open Sans";font-display:swap;font-style:normal;font-weight:400;src:local("Open Sans"),local("OpenSans"),url("/assets/fonts/open-sans-v17-latin-regular.woff2") format("woff2"),url("/assets/fonts/open-sans-v17-latin-regular.woff") format("woff")}@font-face{font-family:"Open Sans";font-display:swap;font-style:normal;font-weight:600;src:local("Open Sans Semibold"),local("OpenSans-Semibold"),url("/assets/fonts/open-sans-v17-latin-600.woff2") format("woff2"),url("/assets/fonts/open-sans-v17-latin-600.woff") format("woff")}.page-title{text-align:left;font-size:200%;line-height:1.2;font-weight:normal}@media(min-width: 600px){.page-title{font-size:250%}}@media(min-width: 1000px){.page-title{font-size:300%}}.meta{color:dimgray;font-weight:300;font-size:120%}@media(min-width: 600px){.meta{font-size:130%}}@media(min-width: 1000px){.meta{font-size:140%}}.sub-meta{color:dimgray;font-weight:300;font-size:100%}@media(min-width: 600px){.sub-meta{font-size:110%}}@media(min-width: 1000px){.sub-meta{font-size:120%}}a.meta{text-align:center;display:block}.title-meta{overflow:auto;color:dimgray;font-size:100%}h1,.h1,h2,.h2,h3,.h3,h4,.h4,h5,.h5,h6,.h6{margin:0 0 .5rem;font-weight:600}a{color:#3d256d}a:hover{color:hsl(260,49.3150684932%,13.6274509804%)}code,pre{border-radius:.2em;background-color:#f5f5f5;border:.1em solid #d3d3d3}code{padding:2px 4px;color:#902f74}pre{padding:16px;overflow-y:hidden}pre code{color:inherit;background-color:rgba(0,0,0,0);padding:0;border:0}h1 .octicon,h2 .octicon,h3 .octicon,h4 .octicon,h5 .octicon,h6 .octicon{visibility:hidden}h1:hover .octicon,h2:hover .octicon,h3:hover .octicon,h4:hover .octicon,h5:hover .octicon,h6:hover .octicon{visibility:visible}.octicon{fill:currentColor;padding:0;vertical-align:middle}body{margin:0}body,p,li,ul,input,textarea{font-size:1em;line-height:1.58;color:#111;font-family:"Open Sans",Helvetica,Arial,sans-serif;overflow-wrap:break-word}img,video,audio,iframe,object{max-width:100%}main{display:block}.line-separator{height:2px;background:#d3d3d3;margin-top:16px;margin-bottom:16px}.clearfix:after{content:"";display:block;clear:both}.content{max-width:700px;margin-right:auto;margin-left:auto;padding:0 16px}.content img{display:block;margin-left:auto;margin-right:auto}.content video{display:block;margin-left:auto;margin-right:auto}.no-list{list-style:none;padding-left:0;margin-left:0}.left{float:left}.right{float:right}.post-list li{margin-bottom:4em;position:relative}.post-list li:before{content:"";position:absolute;bottom:-2em;left:0;background:hsl(0,0%,90%);height:2px;width:60px}.post-list li a{text-decoration:none}.post-list li a:hover{text-decoration:underline}.post-list li .date{color:dimgray;font-size:.8em}.header{background-image:url("/assets/img/banner.svg");background-color:#3a3a3a;background-size:cover;background-position:center center;padding:0;height:auto;margin-bottom:16px}.header .navigation{background:#262626}.header .nav-container{max-width:1000px;margin:0 auto}@media(min-width: 600px){.header{min-height:10em;position:relative;margin-bottom:16px}}nav{height:70px;overflow:hidden}nav ul{margin:0;padding:0;list-style-type:none;max-height:140px;position:relative}nav ul .active{background:#3d256d}nav li{display:inline-block;padding:0}nav a{display:inline-block;padding:0 1em;color:#fff;text-decoration:none;white-space:nowrap;line-height:70px;height:70px}nav a:hover{color:#fff;background-color:#00b2d9}nav li:first-child{left:0;vertical-align:top;font-size:75%}nav li:first-child :hover{color:#fff;background-color:#262626}@media(min-width: 330px){nav li:first-child{font-size:100%}}@media(min-width: 400px){nav li:first-child{font-size:140%}}nav li:last-child{position:absolute;right:0;bottom:70px;background-image:linear-gradient(to right, rgba(38, 38, 38, 0) 0, #262626 2em);padding-left:3em}nav li:nth-last-child(2){display:none}nav#menu:target{height:auto;padding:0}nav#menu:target ul{max-height:none}nav#menu:target li{display:block}nav#menu:target a{display:block;background-color:hsla(0,0%,100%,.05)}nav#menu:target li:not(:first-child){margin-top:2px}nav#menu:target li:not(:first-child) a:hover{background-color:#00b2d9}nav#menu:target li:last-child{display:none}nav#menu:target li:nth-last-child(2){display:inline-block;position:absolute;top:0;right:0;margin:0;border-left:2px solid #262626;background:#3a3a3a}
      
    </style>

    <!-- Contain all special checks needed on AMP pages. Attempt to consolidate checks. -->


  
  <!-- Extract extra <title> tag. -->
  
  
  
  

  
  
  
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->

<meta name="generator" content="Jekyll v4.4.1" />

<meta name="author" content="Kyle Niewiada" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I created a Microsoft Word macro that automatically generated a skeleton entry for today and added up the total hours documented thus far" />
<meta property="og:description" content="I created a Microsoft Word macro that automatically generated a skeleton entry for today and added up the total hours documented thus far" />
<link rel="canonical" href="https://www.kyleniewiada.org/blog/2016/03/word-auto-journal-macro-for-lazy/" />
<meta property="og:url" content="https://www.kyleniewiada.org/blog/2016/03/word-auto-journal-macro-for-lazy/" />
<meta property="og:site_name" content="Kyle Niewiada’s Website" />
<meta property="og:image" content="https://www.kyleniewiada.org/assets/img/2016/03/banner.png" />
<meta property="og:image:height" content="505" />
<meta property="og:image:width" content="964" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-03-14T16:19:00-04:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.kyleniewiada.org/assets/img/2016/03/banner.png" />
<meta property="twitter:title" content="Microsoft Word Auto-Journal Macro for the Lazy" />
<meta name="twitter:site" content="@CrypticCitrus" />
<meta name="twitter:creator" content="@CrypticCitrus" />
<meta property="fb:app_id" content="137961485759" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kyle Niewiada"},"dateModified":"2016-03-14T16:19:00-04:00","datePublished":"2016-03-14T16:19:00-04:00","description":"I created a Microsoft Word macro that automatically generated a skeleton entry for today and added up the total hours documented thus far","headline":"Microsoft Word Auto-Journal Macro for the Lazy","image":{"height":505,"width":964,"url":"https://www.kyleniewiada.org/assets/img/2016/03/banner.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.kyleniewiada.org/blog/2016/03/word-auto-journal-macro-for-lazy/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.kyleniewiada.org/assets/img/logo.png"},"name":"Kyle Niewiada"},"url":"https://www.kyleniewiada.org/blog/2016/03/word-auto-journal-macro-for-lazy/"}</script>
<!-- End Jekyll SEO tag -->

  



     <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZP46JK222K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZP46JK222K');
</script> 
</head>


  <body>
  <!-- start header -->
<header class="header">
  <div class="navigation">
    <div class="nav-container">
      <nav id="menu">
        <ul class="menu-closed">
          
            
            <li class="normal"><a href="/">Kyle Niewiada</a></li>
          
            
            <li class="normal"><a href="/">Home</a></li>
          
            
            <li class="normal"><a href="/about/">About</a></li>
          
            
            <li class="normal"><a href="/archive/">Archive</a></li>
          
            
            <li class="normal"><a href="/contact/">Contact</a></li>
          
            
            <li class="normal"><a href="/resume/">Résumé</a></li>
          
          <li><a href="#">&#215; Close menu</a></li>
          <li><a href="#menu">&#9776; Menu</a></li>
        </ul>
      </nav>
    </div>
  </div>
</header>
<!-- end header -->

    <main class="content">
    <!-- lazy way to hide page title on blog posts -->
    

    <article>
  <header>
    <h1 class="page-title">Microsoft Word Auto-Journal Macro for the Lazy</h1>

    <h2 class="meta">Kyle Niewiada on March 14, 2016</h2>

    <h3 class="meta">
      
      3 Minute Read
       | Small project</h3>
  </header>

  
  <h4 class="sub-meta">Updated on October 01, 2021</h4>
    

  
  <img src="/assets/img/2016/03/banner.png" alt="Microsoft Word output for auto journal macro" />
  

  <div class="line-separator"></div>

  <p>A few months back I was given the requirement for a project to keep some kind of journal logging the number of hours I spent on a task along with a short description. Because the project was deeply integrated with Microsoft products and services, I decided that it would be best to write such a journal with Microsoft Word.</p>

<p>As is the motivation for many projects/scripts of mine, I wanted to automate the process as much as possible such that I never had to think about it again [anytime soon]. This was shortly after I had <a href="/blog/2015/12/making-a-book-from-facebook-messages/">concluded work on a previous project</a> that involved using Microsoft Word with macro scripts. I was ready to learn more about its advanced features. I wanted an automatic running total because I would often forget to recalculate my grand total after each entry. There were probably other solutions that were better suited for this, but I really wanted to see how useful Microsoft Word macros (I know the evil stigma associated with macros) could be to me.</p>
<h4 id="goals">
  
  
    Goals: <a href="#goals" aria-hidden="true" tabindex="-1"><svg class='octicon' viewBox='0 0 16 16' version='1.1' width='16' height='32' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg></a>
  
  
</h4>
    

<ol>
  <li>Automatically insert a new blank entry for today with the cursor ready to write a description</li>
  <li>The ability to total hours for all entries without the user remembering</li>
  <li>Automatically update total hours at top of document</li>
</ol>
<h4 id="results">
  
  
    Results: <a href="#results" aria-hidden="true" tabindex="-1"><svg class='octicon' viewBox='0 0 16 16' version='1.1' width='16' height='32' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg></a>
  
  
</h4>
    

<p>I created a Microsoft Word macro enabled document that when opened will:</p>

<ol>
  <li>Automatically remove empty paragraphs that Microsoft Word <em>loves</em> to place at the end of your document</li>
  <li>Add skeleton text containing today’s date, start, end, and total time</li>
  <li>Add a paragraph labeled “Description:”</li>
  <li>Calculate total hours on exit without user needing to remember</li>
  <li>Automatically add skeleton entry on document open</li>
</ol>
<h3 id="what-it-does">
  
  
    What it does <a href="#what-it-does" aria-hidden="true" tabindex="-1"><svg class='octicon' viewBox='0 0 16 16' version='1.1' width='16' height='32' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg></a>
  
  
</h3>
    

<p>I have provided an example document below. It includes a text-button to add the total number of hours for each entry and another text-button to add new journal entries.</p>

<p>The macro calculates the total number of hours entered by searching for the ‘Total [*]’ string. When it matches, it will add the number found between ‘[]’ to a running total until the entire document has been searched. It will then return the total. The example document shows this total at the top. It is not foolproof. It can be easily defeated if someone decides to include the ‘Total [*]’ string inside their journal entry, or if one wants to overflow the numbers. But it works for me without any major issues (including the null value case), and that is what mattered.</p>

<p>The macro adds a new journal entry to the end of the text by searching for the end of the document, removing any extra paragraphs at the end of the document, and then adding in the pre-scripted skeleton structure for a new journal entry with the date of today. During planning, I could have gone above and beyond and calculated the total hours between the start time and end time of a task/added it to the ‘Total []’ field, but I decided to draw the line there. The amount of work I was putting in for something that would take no time to accomplish would not be paying off.</p>

<p>When the document is closed, the macro will run and add up the total number of hours from the listed entries automatically. A save dialog will then pop up and the user may choose to save or discard changes.</p>
<h3 id="source-code-and-example-document">
  
  
    Source code and example document <a href="#source-code-and-example-document" aria-hidden="true" tabindex="-1"><svg class='octicon' viewBox='0 0 16 16' version='1.1' width='16' height='32' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg></a>
  
  
</h3>
    

<p><a href="/assets/files/2016/03/JournalExample.docm">Microsoft Word Auto-Journal example document</a></p>

<p>Above is a link to the macro enabled Microsoft Word document example. Below is the source code for the macro. Most of it is pieced together from other examples online accomplishing similar tasks. I spent most of my time looking at different resources for visual basic techniques and have mentioned those sources in nearby comments for pieces of code where available.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">Sub</span> <span class="nf">AutoOpen</span><span class="p">()</span>

    <span class="k">Call</span> <span class="n">autoText</span>

<span class="k">End</span> <span class="k">Sub</span>

<span class="c1">'Generate form fill text for document on call</span>
<span class="k">Sub</span> <span class="nf">autoText</span><span class="p">()</span>

    <span class="c1">'remove the empty paragraph that word likes to add to the end of the document on open.</span>
    <span class="k">Call</span> <span class="n">removeEmptyPara</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">EndKey</span> <span class="n">Unit</span><span class="p">:</span><span class="o">=</span><span class="n">wdStory</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">TypeParagraph</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InsertDateTime</span> <span class="n">DateTimeFormat</span><span class="p">:</span><span class="o">=</span><span class="s">"MMMM dd, yyyy"</span><span class="p">,</span> <span class="n">_</span>
    <span class="n">InsertAsField</span><span class="p">:</span><span class="o">=</span><span class="k">False</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">TypeText</span> <span class="n">vbTab</span> <span class="o">&amp;</span> <span class="s">"Start [] End [] Total []"</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">EndKey</span> <span class="n">Unit</span><span class="p">:</span><span class="o">=</span><span class="n">wdStory</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">TypeParagraph</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">TypeText</span> <span class="s">"Description: "</span>

<span class="k">End</span> <span class="k">Sub</span>

<span class="c1">'Removes empty paragraphs located at the end of the document</span>
<span class="k">Sub</span> <span class="nf">removeEmptyPara</span><span class="p">()</span>
    <span class="c1">'https://www.extendoffice.com/documents/word/647-word-remove-empty-paragraphs.html</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">ClearFormattin</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">ClearFormatting</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span>
        <span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">"^p^p"</span>
        <span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">""</span>
        <span class="p">.</span><span class="n">Forward</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">Wrap</span> <span class="o">=</span> <span class="n">wdFindContinue</span>
        <span class="p">.</span><span class="n">Format</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchCase</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchWholeWord</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchByte</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchAllWordForms</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchSoundsLike</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchWildcards</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">MatchFuzzy</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">End</span> <span class="k">With</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">Execute</span> <span class="n">Replace</span><span class="p">:</span><span class="o">=</span><span class="n">wdReplaceAll</span>

<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">AutoClose</span><span class="p">()</span>

    <span class="k">Call</span> <span class="n">findTotal</span>

<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">findTotal</span><span class="p">()</span>

    <span class="c1">'based on https://stackoverflow.com/questions/6425595/word-vba-how-to-select-text-between-two-substrings-and-assign-to-variable</span>

    <span class="k">Dim</span> <span class="nv">firstTerm</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">Dim</span> <span class="nv">secondTerm</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">Dim</span> <span class="nv">myRange</span> <span class="ow">As</span> <span class="n">Range</span>
    <span class="k">Dim</span> <span class="nv">documentText</span> <span class="ow">As</span> <span class="kt">String</span>

    <span class="k">Dim</span> <span class="nv">startPos</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="c1">'Stores the starting position of firstTerm</span>
    <span class="k">Dim</span> <span class="nv">stopPos</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="c1">'Stores the starting position of secondTerm based on first term's location</span>
    <span class="k">Dim</span> <span class="nv">nextPosition</span> <span class="ow">As</span> <span class="kt">Long</span> <span class="c1">'The next position to search for the firstTerm</span>
    <span class="k">Dim</span> <span class="nv">total</span> <span class="ow">As</span> <span class="kt">Double</span>

    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nextPosition</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">firstTerm</span> <span class="o">=</span> <span class="s">"Total ["</span>
    <span class="n">secondTerm</span> <span class="o">=</span> <span class="s">"]"</span>

    <span class="c1">'Get all the document text and store it in a variable.</span>
    <span class="k">Set</span> <span class="n">myRange</span> <span class="o">=</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Range</span>
    <span class="c1">'Maximum limit of a string is 2 billion characters.</span>
    <span class="c1">'So, hopefully your document is not bigger than that.  However, expect declining performance based on how big doucment is</span>
    <span class="n">documentText</span> <span class="o">=</span> <span class="n">myRange</span><span class="p">.</span><span class="n">Text</span>

    <span class="c1">'Loop documentText till you can't find any more matching "terms"</span>
    <span class="k">Do</span> <span class="n">Until</span> <span class="n">nextPosition</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">startPos</span> <span class="o">=</span> <span class="n">InStr</span><span class="p">(</span><span class="n">nextPosition</span><span class="p">,</span> <span class="n">documentText</span><span class="p">,</span> <span class="n">firstTerm</span><span class="p">,</span> <span class="n">vbTextCompare</span><span class="p">)</span>
        <span class="n">stopPos</span> <span class="o">=</span> <span class="n">InStr</span><span class="p">(</span><span class="n">startPos</span><span class="p">,</span> <span class="n">documentText</span><span class="p">,</span> <span class="n">secondTerm</span><span class="p">,</span> <span class="n">vbTextCompare</span><span class="p">)</span>

        <span class="c1">'prevents empty brackets from crashing macro</span>
        <span class="k">If</span> <span class="n">stopPos</span> <span class="o">-</span> <span class="n">startPos</span> <span class="o">&lt;&gt;</span> <span class="n">Len</span><span class="p">(</span><span class="n">firstTerm</span><span class="p">)</span> <span class="k">Then</span>
            <span class="c1">'Debug.Print Mid$(documentText, startPos + Len(firstTerm), stopPos - startPos - Len(firstTerm))</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="n">Mid</span><span class="err">$</span><span class="p">(</span><span class="n">documentText</span><span class="p">,</span> <span class="n">startPos</span> <span class="o">+</span> <span class="n">Len</span><span class="p">(</span><span class="n">firstTerm</span><span class="p">),</span> <span class="n">stopPos</span> <span class="o">-</span> <span class="n">startPos</span> <span class="o">-</span> <span class="n">Len</span><span class="p">(</span><span class="n">firstTerm</span><span class="p">))</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">nextPosition</span> <span class="o">=</span> <span class="n">InStr</span><span class="p">(</span><span class="n">stopPos</span><span class="p">,</span> <span class="n">documentText</span><span class="p">,</span> <span class="n">firstTerm</span><span class="p">,</span> <span class="n">vbTextCompare</span><span class="p">)</span>
    <span class="k">Loop</span>

    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="s">"Total = "</span><span class="err">;</span> <span class="n">total</span>
    <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Variables</span><span class="p">(</span><span class="s">"total"</span><span class="p">).</span><span class="n">Delete</span>
    <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Variables</span><span class="p">.</span><span class="n">Add</span> <span class="n">Name</span><span class="p">:</span><span class="o">=</span><span class="s">"total"</span><span class="p">,</span> <span class="n">Value</span><span class="p">:</span><span class="o">=</span><span class="n">total</span>
    <span class="c1">'MsgBox "I'm done"</span>
    <span class="k">Call</span> <span class="n">UpdateAll</span>

<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">UpdateAll</span><span class="p">()</span>
    <span class="c1">'Based on unknown source.</span>
    <span class="k">Dim</span> <span class="nv">oStory</span> <span class="ow">As</span> <span class="n">Range</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">oStory</span> <span class="ow">In</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">StoryRanges</span>
        <span class="n">oStory</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Update</span>
        <span class="k">If</span> <span class="n">oStory</span><span class="p">.</span><span class="n">StoryType</span> <span class="o">&lt;&gt;</span> <span class="n">wdMainTextStory</span> <span class="k">Then</span>
            <span class="k">While</span> <span class="k">Not</span> <span class="p">(</span><span class="n">oStory</span><span class="p">.</span><span class="n">NextStoryRange</span> <span class="ow">Is</span> <span class="k">Nothing</span><span class="p">)</span>
                <span class="k">Set</span> <span class="n">oStory</span> <span class="o">=</span> <span class="n">oStory</span><span class="p">.</span><span class="n">NextStoryRange</span>
                <span class="n">oStory</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Update</span>
            <span class="k">Wend</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span> <span class="n">oStory</span>
    <span class="k">Set</span> <span class="n">oStory</span> <span class="o">=</span> <span class="k">Nothing</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

  <div class="line-separator"></div>

  <!-- POST NAVIGATION -->
<div class="post-nav">
  
    <a class="post-nav-link" href="/blog/2015/12/making-a-book-from-facebook-messages/">
    <div class="link-text previous">&laquo;&nbsp;Creating a Hardcover Book from a Plethora of Facebook Messages</div>
    
      <img class="link-image" src="/assets/img/2015/12/banner.jpg" alt="Previous Article">
    
    </a>
  
  
    <a class="post-nav-link" href="/blog/2016/03/easy-inline-usb-power-switch/">
    <div class="link-text next">My Easy In-line USB Power Switch&nbsp;&raquo;</div>
    
      <img class="link-image" src="/assets/img/2016/03/banner2.jpg" alt="Next Article">
    
    </a>
  
</div>

</article>


    
<!-- Add Disqus comments. -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'kyleniewiada'; // required: replace example with your forum shortname
  var disqus_identifier = "/blog/2016/03/word-auto-journal-macro-for-lazy/";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </main>
  <!-- start footer -->
<footer class="content">
  <div class="flex-list">
  <ul>
  
    <li>
      <a href="https://www.linkedin.com/in/kyleniewiada/" >LinkedIn</a>
    </li>
  
    <li>
      <a href="https://github.com/aav7fl" >GitHub</a>
    </li>
  
    <li>
      <a href="https://bsky.app/profile/crypticcitrus.bsky.social" >Bluesky</a>
    </li>
  
    <li>
      <a href="https://www.youtube.com/user/KyleNiewiada" >YouTube</a>
    </li>
  
    <li>
      <a href="https://kyleniewiada.bandcamp.com/" rel='nofollow'>BandCamp</a>
    </li>
  
    <li>
      <a href="/sitemap/" >Sitemap</a>
    </li>
  
  </ul>
</div>

</footer>
<!-- start noncritical style -->
<link rel="preload" href="/assets/css/noncritical.css" as="style" onload="this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="/assets/css/noncritical.css"></noscript>
<script>
  /*loadCss*/
  !function(w){"use strict";var loadCSS=function(href,before,media){function ready(cb){return doc.body?cb():void setTimeout(function(){ready(cb)})}function loadCB(){ss.addEventListener&&ss.removeEventListener("load",loadCB),ss.media=media||"all"}var ref,doc=w.document,ss=doc.createElement("link");if(before)ref=before;else{var refs=(doc.body||doc.getElementsByTagName("head")[0]).childNodes;ref=refs[refs.length-1]}var sheets=doc.styleSheets;ss.rel="stylesheet",ss.href=href,ss.media="only x",ready(function(){ref.parentNode.insertBefore(ss,before?ref:ref.nextSibling)});var onloadcssdefined=function(cb){for(var resolvedHref=ss.href,i=sheets.length;i--;)if(sheets[i].href===resolvedHref)return cb();setTimeout(function(){onloadcssdefined(cb)})};return ss.addEventListener&&ss.addEventListener("load",loadCB),ss.onloadcssdefined=onloadcssdefined,onloadcssdefined(loadCB),ss};"undefined"!=typeof exports?exports.loadCSS=loadCSS:w.loadCSS=loadCSS}("undefined"!=typeof global?global:this);

  /*link[rel=preload] polyfill*/
  !function(w){if(w.loadCSS){var rp=loadCSS.relpreload={};if(rp.support=function(){try{return w.document.createElement("link").relList.supports("preload")}catch(e){return!1}},rp.poly=function(){for(var links=w.document.getElementsByTagName("link"),i=0;i<links.length;i++){var link=links[i];"preload"===link.rel&&"style"===link.getAttribute("as")&&(w.loadCSS(link.href,link),link.rel=null)}},!rp.support()){rp.poly();var run=w.setInterval(rp.poly,300);w.addEventListener&&w.addEventListener("load",function(){w.clearInterval(run)}),w.attachEvent&&w.attachEvent("onload",function(){w.clearInterval(run)})}}}(this);
</script>
<!-- end noncritical style -->
<!-- end footer -->

  </body>
</html>
